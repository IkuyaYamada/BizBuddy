# BizBuddy - タスク管理アプリケーション

## 機能一覧

### コア機能
- タスク管理（CRUD）
  - タスクの作成、編集、削除
  - 優先度とモチベーションの設定（0-100）
  - ステータス管理（未着手、進行中、完了、カジュアル、バックログ）
  - 期限設定と残り時間表示
  - 作成日時の記録
  - タスクの説明文にマークダウン対応
  - タスク一覧の自動ソート（ステータス・優先度順）
  - タスク選択のキーボードショートカット（Ctrl + 1-9）
  - 上下ボタンでの素早い並び替え

### アクションプラン機能
- タスクの階層管理
  - サブタスク（最大3つ）
  - リーフタスク（サブタスクごとに最大3つ）
  - アクションアイテム（リーフタスクごとに複数設定可能）
- 進捗管理
  - アクションアイテムの完了/未完了管理
  - リーフタスク、サブタスク、タスクごとの進捗率表示
  - リアルタイムの進捗更新
  - 完了時の階層パス表示（メインタスク > サブタスク > アクション）
- インライン編集
  - タイトルの編集（サブタスク、リーフタスク）
  - アクションアイテムの内容編集（Ctrl + Enterで保存）
  - 削除時の確認機能

### モチベーション機能
- タスク完了時の視覚的フィードバック
- 進捗バーによる達成度の可視化
- 完了タスク数のカウント表示
- モチベーショナルメッセージの表示
- 完了時の振り返り機能
  - 感想・振り返りの記録
  - 成果物・結果の記録
  - 階層構造を含めた完了ログ

### メモ機能
- クイックメモの作成と管理
- メモからタスクの作業ログへの変換
- タスクとメモの関連付け
- マークダウン形式対応
- インライン編集・削除
- 最終編集日時順でのソート

### 作業ログ機能
- タスクごとの作業ログ記録
- 作業開始・終了時刻の管理
- 作業内容のマークダウン記録
- 新しい順での表示
- インライン削除確認

### UI/UX
- タブベースのインターフェース
- キーボードショートカット
  - Ctrl + Enter: フォーム送信
  - Ctrl + J: タスクタブ
  - Ctrl + M: メモタブ
  - Ctrl + 1-9: タスク選択
  - Ctrl + Alt + N (Windows) / Ctrl + N (Mac): 新規タスク作成
- レスポンシブデザイン
- 直感的な操作性
- ステータスに応じた視覚的フィードバック
- リサイズ可能なパネルレイアウト
- ストップウォッチ・カウントダウン機能（デフォルト15分）

## 技術スタック

### バックエンド
- Python
- FastAPI
- SQLite
- SQLAlchemy

### フロントエンド
- Next.js
- TypeScript
- Tailwind CSS
- HeadlessUI

## セットアップ

### バックエンド
```bash
cd backend
python -m venv venv
source venv/bin/activate  # Windowsの場合: venv\Scripts\activate
pip install -r requirements.txt
uvicorn app.main:app --reload
```

### フロントエンド
```bash
cd frontend
npm install
npm run dev
```

## 開発状況

現在の実装状況：
- ✅ 基本的なタスク管理機能（CRUD）
- ✅ デモ機能
- ✅ 作業ログ機能
- ✅ マークダ���ン対応
- ✅ キーボードショートカット
- ✅ タスクの自動ソート
- ✅ ストップウォッチ・カウントダウン機能
- ✅ リサイズ可能なパネル
- ✅ ドチベーション機能
- ✅ 階層構造を含めた完了ログ
- ✅ タイムゾーン対応（JST）
- ✅ 上下ボタンによる並び替え

今後の実装予定：
- カテゴリ機能
- マインドマップ機能
- タスクの統合/分割機能
- プロトタイプ機能

## 既知の問題と対処方法

### 階層型タスク関連
1. サブタスクの作成が不安定になる場合
   - 原因：状態の非同期更新やキャッシュの問題
   - 対処：
     - タスクの再作成
     - ブラウザのリロード
     - `make reset-hierarchical`コマンドでテーブルのリセット

2. Mac環境での特有の問題
   - タスクの状態更新が遅延する場合がある
   - 画面遷移後のデータ不整合
   - 対処：
     - 状態管理をカスタムフックに一元化
     - 不要な再レンダリングの削減

3. データベースの整合性
   - 外部キー制約による削除エラー
   - 対処：
     - カスケード削除の適切な設定
     - `reset-hierarchical`コマンドの利用

## トラブルシューティング

### データベースのリセット
階層型タスクのテーブルのみを初期化する場合：
```bash
make reset-hierarchical
```

### 状態の初期化
フロントエンド側の状態をリセットする場合：
1. ブラウザのローカルストレージをクリア
2. アプリケーションをリロード

### 開発環境の再起動
問題が解決しない場合：
```bash
# バックエンドの再起動
make backend

# フロントエンドの再起動
make frontend
```

## 最近の改善点（2024年1月）

1. 状態管理の改善
   - カスタムフック（useHierarchicalTasks）の導入
   - 状態更新ロジックの一元化
   - エラーハンドリングの強化

2. パフォーマンスの最適化
   - 不要な再レンダリングの削減
   - メモ化による最適化
   - ドラッグ＆ドロップ機能の削除による安定性向上

3. ユーザビリティの向上
   - 上下ボタンによる直感的な操作
   - エラー時のフィードバック改善
   - タイムゾーン対応の強化

4. バグ修正
   - Mac環境での表示の安定化
   - 階層構造の整合性確保
   - 完了ログの正確な記録
